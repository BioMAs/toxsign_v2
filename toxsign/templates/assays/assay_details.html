{% extends "base.html" %}
{% load static i18n %}

{% block content %}
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.9.1/d3-tip.min.js"></script>
<link href="{% static 'css/graph.css' %}" rel="stylesheet">
<script src="{% static 'js/graph.js' %}"></script>
<script src="{% static 'js/context-menu.js' %}"></script>
    <div class="container-fluid">
      <div class="tab-content card" style="text-align:center;">
        <div class="tab-pane active text-style card-body">
          <div id='graph'></div>
          <script>
            d3.json("{% url 'graph' %}?q={{project.tsx_id}}").then( function(json){
              drawGraph(json.data, json.max_parallel, json.max_depth, "{{assay.tsx_id}}");
            });
          </script>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="col-md-3 ">
          <div class="list-group ">
              <a href="#tab1" data-toggle="tab" class="list-group-item list-group-item-action">Project</a>
              <a href="#tab2" data-toggle="tab" class="list-group-item list-group-item-action active">Assay</a>
              <a href="#tab3" data-toggle="tab" class="list-group-item list-group-item-action">Factors ({{ factors|length }})</a>
              <a href="#tab4" data-toggle="tab" class="list-group-item list-group-item-action">Signatures ({{ signatures|length }})</a>
            </div>
        </div>
        <div class="col-md-9">
            <div class="tab-content card">
              <div class="tab-pane text-style card-body" id="tab1">
                <h2><a href="{% url 'projects:detail' project.tsx_id %}">{{ project.tsx_id }}</a> - {{ project.name }}</h2>
                <p>{{ project.description }}</p>
              </div>
              <div class="tab-pane active text-style card-body" id="tab2">
                <h2>{{ assay.tsx_id }} - {{ assay.name }}</h2>
              </div>
              <div class="tab-pane text-style card-body" id="tab3">
                <h2> List of factors related to this assay : </h2>
                {% if not factors %}
                  <p> No factors are related to this assay</p>
                {% endif %}
                {% for factor in factors %}
                  <p><a href="{% url 'assays:factor_detail' factor.tsx_id %}"> {{factor.tsx_id}}</a> - {{factor.name}}</p>
                  <hr>
                {% endfor %}
                <br>
                <a class="btn btn-large btn-info" href="{% url 'assays:factor_create' project.tsx_id %}?selected={{assay.tsx_id}}">
                  <i class="fa fa-plus-circle"></i> New factor
                </a>
              </div>
              <div class="tab-pane text-style card-body" id="tab4">
                <h2> List of signatures related to this assay : </h2>
                {% if not signatures %}
                  <p> No signatures are related to this project.</p>
                {% endif %}
                {% for signature in signatures %}
                  <h2><a href="{% url 'signatures:detail' signature.tsx_id %}">{{ signature.tsx_id }}</a> - {{ signature.name }}</h2>
                  <hr>
                {% endfor %}
              </div>
            </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="modal-group">
        <div class="modal-dialog modal-lg">
            <div class="modal-content"></div>
        </div>
    </div>

{% endblock %}
